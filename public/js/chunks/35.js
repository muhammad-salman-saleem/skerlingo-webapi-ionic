(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{209:function(t,e,i){"use strict";i.r(e);var a=i(2);function s(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var r={components:{TiptapVuetify:a.o},data:function(){return{url:"meetings",search:"",headers:[{text:"Importer",align:"middle",value:"importer_label"},{text:"Sujet",align:"middle",value:"sujet",width:"280px"},{text:"Subscriptions",align:"middle",value:"subscriptions_count"},{text:"Date",align:"middle",value:"date"},{text:"",align:"right",value:"actions",sortable:!1}],filter:{type:null,secteur:null,entreprise:null,validation_skerlingo:null,validation_exporteur:null},validationErrors:null,meetings:[],importateurs:[],rubriques:[],types:[],meeting:{id:null,sujet:null,message:null,image:null,image_url:null,secteur_id:null,importer_id:null,date_debut:null,date_fin:null,keywords:[],images:[]},edit:!1,menu1:!1,menu2:!1,extensions:[a.g,a.a,a.j,a.q,a.n,a.i,a.k,a.c,a.l,[a.f,{options:{levels:[1,2,3]}}],a.b,a.d,a.h,a.m,a.e]}},computed:{_headers:function(){return this.headers.filter((function(t){return!t.hide}))}},created:function(){this.fetch()},methods:{fetch:function(){var t={};$.each(this.filter,(function(e,i){t[e]=i})),axios.get(this.url,{params:t}).then(function(t){t.data.importateurs&&(this.importateurs=t.data.importateurs),this.types=t.data.types,this.rubriques=t.data.rubriques,this.meetings=t.data.meetings}.bind(this)).catch((function(t){return console.log(t)}))},saveMeeting:function(){var t=this,e=new FormData;$.each(this.meeting,(function(t,i){e.append(t,i||"")})),e.append("keywords",JSON.stringify(this.meeting.keywords)),axios.post(this.url,e,{headers:{"content-type":"multipart/form-data"}}).then((function(e){swal.fire(e.data.title,e.data.message,"success"),t.clearForm(),$("#modal_form_meeting").modal("toggle"),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},addMeeting:function(){this.clearForm(),this.meeting.image_url="https://via.placeholder.com/300/004c68/FFF?text=Image",this.validationErrors=null;new KTImageInput("kt_user_edit_avatar_meeting"),new KTImageInput("kt_user_edit_avatar_meeting_image")},editMeeting:function(t){t=_.cloneDeep(t),$("#modal_form_meeting").modal("toggle"),this.validationErrors=null,this.edit=!0;new KTImageInput("kt_user_edit_avatar_meeting"),new KTImageInput("kt_user_edit_avatar_meeting_image");$.each(this.meeting,function(e,i){this.meeting[e]=t[e]}.bind(this))},valider_meeting:function(t,e){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de valider ce meeting !",type:"question",showCancelButton:!0,confirmButtonText:"Valider",cancelButtonText:"Annuler"}).then(function(i){var a=this;if(i.value){var s={};s.id=t,s.type=e,axios.get("meetings/valider_meeting",{params:s}).then((function(t){a.$root.$refs.AdminSideBar.fetch(),swal.fire("Meeting Validé","Le meeting a été validé avec succés.","success"),a.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},annuler_meeting:function(t,e){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point d'annuler la validation du meeting !",type:"question",showCancelButton:!0,confirmButtonText:"Annuler la validation",cancelButtonText:"Fermer"}).then(function(i){var a=this;if(i.value){var s={};s.id=t,s.type=e,axios.get("meetings/annuler_meeting",{params:s}).then((function(t){a.$root.$refs.AdminSideBar.fetch(),swal.fire("Validation annulé","La validation a été annulée avec succés.","success"),a.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},deleteMeeting:function(t){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de supprimer ce meeting !",type:"question",showCancelButton:!0,confirmButtonText:"Supprimer",cancelButtonText:"Annuler"}).then(function(e){var i=this;e.value&&axios.post(this.url+"/"+t,{_method:"DELETE"}).then((function(t){swal.fire("Meeting supprimé !","Le Meeting a été supprimé avec succés.","success"),i.fetch()})).catch((function(t){return console.log(t)}))}.bind(this))},removeKeywords:function(t){this.meeting.keywords.splice(this.meeting.keywords.indexOf(t),1),this.meeting.keywords=s(this.meeting.keywords)},clearForm:function(){this.edit=!1,$.each(this.meeting,function(t,e){this.meeting[t]=null}.bind(this))},onImageChangeMeeting:function(t){this.meeting.image=t.target.files[0]},onImageChangeMeetingImage:function(t){var e=this,i=t.target.files[0],a=new FormData;a.append("image",i),this.meeting.id&&a.append("meeting",this.meeting.id),axios.post("meetings/upload_photo",a,{headers:{"content-type":"multipart/form-data"}}).then((function(t){t.data.image&&e.meeting.images.push(t.data.image),$("#kt_user_edit_avatar_meeting_image .remove_photo").trigger("click"),$("#kt_user_edit_avatar_meeting_image input").val(""),$("#kt_user_edit_avatar_meeting_image .image-input-wrapper").css("background-image","url(https://via.placeholder.com/300/004c68/FFF?text=Upload)")})).catch((function(t){422==t.response.status&&(e.validationErrors=t.response.data.errors)}))},deleteImage:function(t){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de supprimer cette image !",type:"question",showCancelButton:!0,confirmButtonText:"Supprimer",cancelButtonText:"Annuler"}).then(function(e){var i=this;e.value&&axios.post(this.url+"/delete_photo/"+t).then((function(e){i.meeting.images=i.meeting.images.filter((function(e){return e.id!=t}))})).catch((function(t){return console.log(t)}))}.bind(this))}}},l=i(4),o=Object(l.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1==t.$auth.user().role_id?i("div",[i("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[i("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[i("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[i("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v("B2B Meetings")]),t._v(" "),i("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[i("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v(t._s(t.meetings.length)+" B2B Meetings")]),t._v(" "),i("form",{staticClass:"ml-5"},[i("div",{staticClass:"input-group input-group-sm input-group-solid",staticStyle:{"max-width":"175px"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v(" "),i("div",{staticClass:"input-group-append"},[i("span",{staticClass:"input-group-text"},[i("span",{staticClass:"svg-icon"},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"}},[i("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[i("rect",{attrs:{x:"0",y:"0",width:"24",height:"24"}}),t._v(" "),i("path",{attrs:{d:"M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z",fill:"#000000","fill-rule":"nonzero",opacity:"0.3"}}),t._v(" "),i("path",{attrs:{d:"M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z",fill:"#000000","fill-rule":"nonzero"}})])])])])])])])])]),t._v(" "),i("div",{staticClass:"d-flex align-items-center"},[i("a",{staticClass:"btn btn-primary btn-sm",attrs:{"data-toggle":"modal",href:"#modal_form_meeting"},on:{click:function(e){return t.addMeeting()}}},[i("i",{staticClass:"ki ki-plus icon-1x"}),t._v("New b2b Meeting\n        ")])])])]),t._v(" "),i("div",{staticClass:"d-flex flex-column-fluid"},[i("div",{staticClass:"container-fluid"},[1==t.$auth.user().role_id?i("div",{staticClass:"card card-custom gutter-b"},[i("div",{staticClass:"card-body p-4 pr-8 pl-8"},[i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-xl-3"},[i("div",{staticClass:"form-group mb-0"},[i("label",[t._v("Secteur")]),t._v(" "),i("v-autocomplete",{attrs:{items:t.rubriques,clearable:"",dense:"",filled:""},scopedSlots:t._u([{key:"item",fn:function(e){return[[i("v-list-item-avatar",{staticStyle:{"border-radius":"0"}},[e.item.parent_label?t._e():i("img",{attrs:{src:e.item.avatar}}),t._v(" "),e.item.parent_label?i("img",{staticStyle:{width:"25px",height:"25px"},attrs:{src:e.item.avatar}}):t._e()]),t._v(" "),i("v-list-item-content",[i("v-list-item-title",{domProps:{innerHTML:t._s(e.item.text)}}),t._v(" "),i("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.parent_label)}})],1)]]}}],null,!1,3605748394),model:{value:t.filter.secteur,callback:function(e){t.$set(t.filter,"secteur",e)},expression:"filter.secteur"}})],1)]),t._v(" "),i("div",{staticClass:"col-xl-3"},[i("div",{staticClass:"form-group mb-0"},[i("label",[t._v("Importateur")]),t._v(" "),i("v-autocomplete",{attrs:{items:t.importateurs,clearable:"",dense:"",filled:""},model:{value:t.filter.entreprise,callback:function(e){t.$set(t.filter,"entreprise",e)},expression:"filter.entreprise"}})],1)]),t._v(" "),i("div",{staticClass:"col-xl-1 mt-7"},[i("button",{staticClass:"btn btn-primary btn-block",on:{click:function(e){return t.fetch()}}},[t._m(0)])])])])]):t._e(),t._v(" "),i("div",{staticClass:"card card-custom gutter-b"},[t._m(1),t._v(" "),i("div",{staticClass:"card-body p-5 pt-0"},[i("v-card",{staticStyle:{"box-shadow":"none"}},[i("v-data-table",{staticClass:"table overflow-initial",attrs:{headers:t._headers,items:t.meetings,search:t.search},scopedSlots:t._u([{key:"item.importer_label",fn:function(e){var a=e.item;return[i("div",{staticClass:"d-flex align-items-center"},[i("div",{staticClass:"symbol symbol-40 symbol-light-success mr-2"},[a.importer_pays_flag?i("img",{attrs:{src:a.importer_pays_flag,alt:""}}):t._e()]),t._v(" "),i("div",{staticClass:"d-flex flex-column flex-grow-1"},[i("router-link",{staticClass:"text-dark text-hover-primary font-size-sm font-weight-bold",attrs:{to:{name:"rfq_item",params:{id:a.id}}}},[t._v(t._s(a.importer_label))]),t._v(" "),i("span",{staticClass:"text-muted font-size-xs"},[t._v(t._s(a.importer_company)+" - "+t._s(a.importer_pays_label))])],1)])]}},{key:"item.date",fn:function(e){var a=e.item;return[i("span",{staticClass:"font-size-sm font-roboto"},[t._v(t._s(a.date))])]}},{key:"item.sujet",fn:function(e){var a=e.item;return[i("span",{staticClass:"font-size-sm font-weight-bold"},[t._v(t._s(a.sujet))])]}},{key:"item.subscriptions_count",fn:function(e){var a=e.item;return[i("span",{staticClass:"label label-lg label-inline font-weight-normal"},[t._v(t._s(a.subscriptions_count))])]}},{key:"item.actions",fn:function(e){var a=e.item;return[i("div",{staticClass:"dropdown dropdown-inline"},[i("a",{staticClass:"btn btn-sm btn-default btn-text-primary btn-hover-primary btn-icon mr-2",attrs:{href:"javascript:;","data-toggle":"dropdown"}},[i("i",{staticClass:"ki ki-bold-more-hor"})]),t._v(" "),i("div",{staticClass:"dropdown-menu dropdown-menu-sm dropdown-menu-right w-300px"},[i("ul",{staticClass:"navi flex-column navi-hover py-2",staticStyle:{"padding-inline-start":"0"}},[i("li",{staticClass:"navi-header font-weight-bolder text-uppercase font-size-xs text-primary pb-2"},[t._v("Actions :")]),t._v(" "),i("li",{staticClass:"navi-item"},[i("router-link",{staticClass:"navi-link",attrs:{to:{name:"meeting_item",params:{id:a.id}}}},[i("span",{staticClass:"navi-icon"},[i("i",{staticClass:"flaticon-eye"})]),t._v(" "),i("span",{staticClass:"navi-text"},[t._v("détails")])])],1),t._v(" "),i("li",{staticClass:"navi-item"},[i("a",{staticClass:"navi-link",on:{click:function(e){return t.editMeeting(a)}}},[i("span",{staticClass:"navi-icon"},[i("i",{staticClass:"flaticon2-edit"})]),t._v(" "),i("span",{staticClass:"navi-text"},[t._v("Modifier")])])]),t._v(" "),i("li",{staticClass:"navi-item"},[i("a",{staticClass:"navi-link",on:{click:function(e){return t.deleteMeeting(a.id)}}},[i("span",{staticClass:"navi-icon"},[i("i",{staticClass:"flaticon-delete-1"})]),t._v(" "),i("span",{staticClass:"navi-text"},[t._v("Supprimer")])])])])])])]}}],null,!1,1305139266)})],1)],1)])])]),t._v(" "),i("div",{staticClass:"modal fade",attrs:{id:"modal_form_meeting",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[t.meeting.id?t._e():i("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("New b2b Meeting")]),t._v(" "),t.meeting.id?i("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Modifier un meeting")]):t._e(),t._v(" "),i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})]),t._v(" "),i("form",{staticClass:"mb-3",on:{submit:function(e){return e.preventDefault(),t.saveMeeting(e)}}},[i("div",{staticClass:"modal-body p-0"},[i("div",{staticClass:"card gutter-b mb-0"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"tab-pane fade show active",attrs:{id:"kt_tab_pane_1_4",role:"tabpanel","aria-labelledby":"kt_tab_pane_1_4"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6 pt-0"},[i("div",{staticClass:"form-group mb-0 pb-0"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Secteur :")]),t._v(" "),i("v-autocomplete",{attrs:{items:t.rubriques,clearable:"",dense:"",filled:""},scopedSlots:t._u([{key:"item",fn:function(e){return[[i("v-list-item-avatar",{staticStyle:{"border-radius":"0"}},[e.item.parent_label?t._e():i("img",{attrs:{src:e.item.avatar}}),t._v(" "),e.item.parent_label?i("img",{staticStyle:{width:"20px",height:"20px","margin-left":"20px"},attrs:{src:e.item.avatar}}):t._e()]),t._v(" "),i("v-list-item-content",[i("v-list-item-title",{domProps:{innerHTML:t._s(e.item.text)}}),t._v(" "),i("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.parent_label)}})],1)]]}}],null,!1,410339934),model:{value:t.meeting.secteur_id,callback:function(e){t.$set(t.meeting,"secteur_id",e)},expression:"meeting.secteur_id"}})],1)]),t._v(" "),i("div",{staticClass:"col-md-6 pt-0"},[i("div",{staticClass:"form-group mb-0"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Importer :")]),t._v(" "),i("v-autocomplete",{attrs:{items:t.importateurs,clearable:"",dense:"",filled:""},model:{value:t.meeting.importer_id,callback:function(e){t.$set(t.meeting,"importer_id",e)},expression:"meeting.importer_id"}})],1)])]),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-12 pt-0"},[i("div",{staticClass:"form-group mb-0"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Sujet :")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.meeting.sujet,expression:"meeting.sujet"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Meeting"},domProps:{value:t.meeting.sujet},on:{input:function(e){e.target.composing||t.$set(t.meeting,"sujet",e.target.value)}}})])])]),t._v(" "),i("div",{staticClass:"form-group mb-1"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Request :")]),t._v(" "),i("tiptap-vuetify",{attrs:{extensions:t.extensions},model:{value:t.meeting.message,callback:function(e){t.$set(t.meeting,"message",e)},expression:"meeting.message"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"form-group mb-0"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("From :")]),t._v(" "),i("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("v-text-field",t._g(t._b({staticClass:"date_picker_text",attrs:{"persistent-hint":""},on:{blur:function(e){t.meeting.date_debut=t.meeting.date_debut}},model:{value:t.meeting.date_debut,callback:function(e){t.$set(t.meeting,"date_debut",e)},expression:"meeting.date_debut"}},"v-text-field",s,!1),a))]}}],null,!1,3309243635),model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[t._v(" "),i("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu1=!1}},model:{value:t.meeting.date_debut,callback:function(e){t.$set(t.meeting,"date_debut",e)},expression:"meeting.date_debut"}})],1)],1)]),t._v(" "),i("div",{staticClass:"col-md-6"},[i("div",{staticClass:"form-group mb-0"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("To :")]),t._v(" "),i("v-menu",{ref:"menu2",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,s=e.attrs;return[i("v-text-field",t._g(t._b({staticClass:"date_picker_text",attrs:{"persistent-hint":""},on:{blur:function(e){t.meeting.date_fin=t.meeting.date_fin}},model:{value:t.meeting.date_fin,callback:function(e){t.$set(t.meeting,"date_fin",e)},expression:"meeting.date_fin"}},"v-text-field",s,!1),a))]}}],null,!1,1421308944),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t._v(" "),i("v-date-picker",{attrs:{"no-title":""},on:{input:function(e){t.menu2=!1}},model:{value:t.meeting.date_fin,callback:function(e){t.$set(t.meeting,"date_fin",e)},expression:"meeting.date_fin"}})],1)],1)])]),t._v(" "),i("div",{staticClass:"form-group"},[i("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Keywords :")]),t._v(" "),i("v-combobox",{attrs:{chips:"",clearable:"",label:"Keywords",multiple:"","prepend-icon":"mdi-filter-variant",solo:""},scopedSlots:t._u([{key:"selection",fn:function(e){var a=e.attrs,s=e.item,n=e.select,r=e.selected;return[i("v-chip",t._b({attrs:{"input-value":r,close:""},on:{click:n,"click:close":function(e){return t.removeKeywords(s)}}},"v-chip",a,!1),[t._v(t._s(s)+" ")])]}}],null,!1,949456501),model:{value:t.meeting.keywords,callback:function(e){t.$set(t.meeting,"keywords",e)},expression:"meeting.keywords"}})],1)]),t._v(" "),t.validationErrors?i("validation-errors",{attrs:{errors:t.validationErrors}}):t._e()],1)])]),t._v(" "),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),i("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-search"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("div",{staticClass:"card-title"},[e("h3",{staticClass:"card-label"},[this._v("B2B Meetings")])])])}],!1,null,null,null);e.default=o.exports}}]);