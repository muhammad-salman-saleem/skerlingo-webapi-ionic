(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{200:function(t,e,a){"use strict";a.r(e);var i=a(23),s=a.n(i),l=a(41),r=a.n(l);function n(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loader=e}var e,a,i;return e=t,(a=[{key:"upload",value:function(){var t=this;return this.loader.file.then((function(e){return new Promise((function(a,i){t._initRequest(),t._initListeners(a,i,e),t._sendRequest(e)}))}))}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}},{key:"_initRequest",value:function(){var t=this.xhr=new XMLHttpRequest;t.open("POST","".concat("https://skerlingo.com","/api/blog_articles/ckeditor_upload"),!0),t.responseType="json"}},{key:"_initListeners",value:function(t,e,a){var i=this.xhr,s=this.loader,l="Couldn't upload file: ".concat(a.name,".");i.addEventListener("error",(function(){return e(l)})),i.addEventListener("abort",(function(){return e()})),i.addEventListener("load",(function(){var a=i.response;if(!a||a.error)return e(a&&a.error?a.error.message:l);t({default:a.url})})),i.upload&&i.upload.addEventListener("progress",(function(t){t.lengthComputable&&(s.uploadTotal=t.total,s.uploaded=t.loaded)}))}},{key:"_sendRequest",value:function(t){var e=new FormData;e.append("upload",t),this.xhr.send(e)}}])&&n(e.prototype,a),i&&n(e,i),t}(),c={components:{"vue-dropify":s.a},data:function(){return{editor:r.a,editorConfig:{extraPlugins:[this.uploader],mediaEmbed:{previewsInData:!0},alignment:{options:["left","right","center","justify"]}},url:"blog_articles",search:"",headers:[{text:"Titre",align:"middle",value:"label"},{text:"Rubrique",align:"middle",value:"type_label"},{text:"",align:"right",value:"actions",sortable:!1}],validationErrors:null,articles:[],types:[],article:{id:null,label:null,image:null,intro:null,contenu:null,image_url:null,type_id:null},edit:!1}},computed:{_headers:function(){return this.headers.filter((function(t){return!t.hide}))}},created:function(){this.article.image_url="https://via.placeholder.com/300/004c68/FFF?text=Image",this.validationErrors=null;new KTImageInput("kt_user_edit_avatar");this.fetch()},mounted:function(){if(this.$route.query.add){$("#modal_form_article").modal("toggle");new KTImageInput("kt_user_edit_avatar")}},methods:{uploader:function(t){t.plugins.get("FileRepository").createUploadAdapter=function(t){return new o(t)}},fetch:function(t){axios.get(this.url).then(function(t){this.articles=t.data.articles,this.types=t.data.types}.bind(this)).catch((function(t){return console.log(t)}))},deleteArticle:function(t){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de supprimer cet article !",type:"question",showCancelButton:!0,confirmButtonText:"Supprimer",cancelButtonText:"Annuler"}).then(function(e){var a=this;e.value&&axios.post("articles/"+t,{_method:"DELETE"}).then((function(t){a.fetch(),swal.fire("Article supprimé !","Le article a été supprimé avec succés.","success")})).catch((function(t){return console.log(t)}))}.bind(this))},saveArticle:function(){var t=this,e=new FormData;$.each(this.article,(function(t,a){e.append(t,a||"")})),this.variantes&&e.append("variantes",JSON.stringify(this.variantes)),axios.post(this.url,e,{headers:{"content-type":"multipart/form-data"}}).then((function(e){t.clearForm(),$("#modal_form_article").modal("toggle"),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},addArticle:function(){this.clearForm();new KTImageInput("kt_user_edit_avatar");this.validationErrors=null},editArticle:function(t){$("#modal_form_article").modal("toggle"),this.validationErrors=null,this.edit=!0,$.each(this.article,function(e,a){this.article[e]=t[e]}.bind(this))},clearForm:function(){this.edit=!1,this.variantes=[],$.each(this.article,function(t,e){"contenu"!=t&&(this.article[t]=null),"contenu"==t&&(this.article[t]="")}.bind(this))},onImageChange:function(t){this.article.image=t.target.files[0]}}},d=a(4),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[a("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[a("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[a("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v("Articles")]),t._v(" "),a("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[a("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v(t._s(t.articles.length)+" articles")]),t._v(" "),a("form",{staticClass:"ml-5"},[a("div",{staticClass:"input-group input-group-sm input-group-solid",staticStyle:{"max-width":"175px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v(" "),a("div",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text"},[a("span",{staticClass:"svg-icon"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"}},[a("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[a("rect",{attrs:{x:"0",y:"0",width:"24",height:"24"}}),t._v(" "),a("path",{attrs:{d:"M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z",fill:"#000000","fill-rule":"nonzero",opacity:"0.3"}}),t._v(" "),a("path",{attrs:{d:"M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z",fill:"#000000","fill-rule":"nonzero"}})])])])])])])])])]),t._v(" "),a("div",{staticClass:"d-flex align-items-center"},[1==t.$auth.user().role_id?a("a",{staticClass:"btn btn-nice btn-primary btn-sm",attrs:{"data-toggle":"modal",href:"#modal_form_article"},on:{click:function(e){return t.addArticle()}}},[a("i",{staticClass:"ki ki-plus icon-1x"}),t._v("Ajouter un article\n        ")]):t._e()])])]),t._v(" "),a("div",{staticClass:"d-flex flex-column-fluid"},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"card card-custom gutter-b"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body p-2 pt-0"},[a("v-card",{staticStyle:{"box-shadow":"none"}},[a("v-data-table",{staticClass:"table",attrs:{headers:t._headers,items:t.articles,search:t.search},scopedSlots:t._u([{key:"item.label",fn:function(e){var i=e.item;return[a("div",{staticClass:"d-flex align-items-center",staticStyle:{"max-width":"200px"}},[a("div",{staticClass:"symbol symbol-50 symbol-light-success mr-2"},[a("img",{attrs:{src:i.image_url,alt:""}})]),t._v(" "),a("div",{staticClass:"d-flex flex-column flex-grow-1"},[a("a",{staticClass:"text-dark text-hover-primary font-weight-bold",attrs:{href:"#"}},[t._v(t._s(i.label))])])])]}},{key:"item.couleur_label",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(i.couleur_label?i.couleur_label:"-"))])]}},{key:"item.taille_label",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(i.taille_label?i.taille_label:"-"))])]}},{key:"item.client_label",fn:function(e){var i=e.item;return[a("div",{staticClass:"d-flex align-items-center"},[a("div",{staticClass:"symbol symbol-40 symbol-light-success mr-2"},[a("img",{attrs:{src:i.client_image,alt:""}})]),t._v(" "),a("div",{staticClass:"d-flex flex-column flex-grow-1"},[a("a",{staticClass:"text-dark text-hover-primary font-weight-bold",attrs:{href:"#"}},[t._v(t._s(i.client_label))]),t._v(" "),a("span",{staticClass:"text-muted"},[t._v(t._s(i.client_tel))])])])]}},{key:"item.longueur",fn:function(e){var i=e.item;return[a("span",[t._v(t._s(i.longueur)+" / "+t._s(i.largeur)+" / "+t._s(i.hauteur)+" cm")])]}},{key:"item.poids",fn:function(e){var i=e.item;return[a("span",{staticClass:"label label-lg label-light-primary label-inline font-weight-normal"},[t._v(t._s(i.poids)+" KG")])]}},{key:"item.prix",fn:function(e){var i=e.item;return[a("span",{staticClass:"label label-lg label-primary label-inline font-weight-normal"},[t._v(t._s(i.prix)+" MAD")])]}},{key:"item.stock_interne",fn:function(e){var i=e.item;return[a("span",{staticClass:"label label-lg label-warning label-inline font-weight-normal"},[t._v(t._s(i.stock_interne))])]}},{key:"item.stock",fn:function(e){var i=e.item;return[a("span",{staticClass:"label label-lg label-danger bg-gray-600 label-inline font-weight-normal"},[t._v(t._s(i.stock))])]}},{key:"item.actions",fn:function(e){var i=e.item;return[a("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:i.url_page,target:"_blank"}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[a("i",{staticClass:"flaticon-eye"})])]),t._v(" "),a("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:"#"},on:{click:function(e){return t.editArticle(i)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[a("i",{staticClass:"flaticon-edit"})])]),t._v(" "),a("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:"#"},on:{click:function(e){return t.deleteArticle(i.id)}}},[a("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[a("i",{staticClass:"flaticon-delete"})])])]}}])})],1)],1)])])]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:"modal_form_article",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[t.article.id?t._e():a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Ajouter un article")]),t._v(" "),t.article.id?a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Modifier un article")]):t._e(),t._v(" "),t._m(1)]),t._v(" "),a("form",{staticClass:"mb-3",on:{submit:function(e){return e.preventDefault(),t.saveArticle(e)}}},[a("div",{staticClass:"modal-body"},[t.validationErrors?a("validation-errors",{attrs:{errors:t.validationErrors}}):t._e(),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-8"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"form-group mb-0"},[a("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Rubrique :")]),t._v(" "),a("v-autocomplete",{attrs:{items:t.types,clearable:"",dense:"",solo:""},model:{value:t.article.type_id,callback:function(e){t.$set(t.article,"type_id",e)},expression:"article.type_id"}})],1)]),t._v(" "),a("div",{staticClass:"col-md-8"},[a("div",{staticClass:"form-group mb-0"},[a("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Titre")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.article.label,expression:"article.label"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Titre"},domProps:{value:t.article.label},on:{input:function(e){e.target.composing||t.$set(t.article,"label",e.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"form-group mb-2"},[a("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Introduction")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.article.intro,expression:"article.intro"}],staticClass:"form-control",attrs:{placeholder:"Introduction",rows:"3"},domProps:{value:t.article.intro},on:{input:function(e){e.target.composing||t.$set(t.article,"intro",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"d-block mb-3"},[t._v("Photo")]),t._v(" "),a("div",[a("div",{staticClass:"image-input image-input-empty image-input-outline",staticStyle:{width:"100%"},style:{"background-image":"url("+t.article.image_url+")"},attrs:{id:"kt_user_edit_avatar"}},[a("div",{staticClass:"image-input-wrapper",staticStyle:{width:"100%",height:"170px"}}),t._v(" "),a("label",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"change","data-toggle":"tooltip",title:"","data-original-title":"Change avatar"}},[a("i",{staticClass:"fa fa-pen icon-sm text-muted"}),t._v(" "),a("input",{attrs:{type:"file",name:"image",accept:".png, .jpg, .jpeg"},on:{change:t.onImageChange}}),t._v(" "),a("input",{attrs:{type:"hidden",name:"profile_avatar_remove"}})]),t._v(" "),t._m(2),t._v(" "),t._m(3)])])])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Article")]),t._v(" "),a("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig},model:{value:t.article.contenu,callback:function(e){t.$set(t.article,"contenu",e)},expression:"article.contenu"}})],1)],1),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("div",{staticClass:"card-title"},[e("h3",{staticClass:"card-label"},[this._v("Liste des Articles")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("i",{staticClass:"ki ki-close",attrs:{"aria-hidden":"true"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"cancel","data-toggle":"tooltip",title:"Cancel avatar"}},[e("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"remove","data-toggle":"tooltip",title:"Remove avatar"}},[e("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])}],!1,null,null,null);e.default=u.exports}}]);