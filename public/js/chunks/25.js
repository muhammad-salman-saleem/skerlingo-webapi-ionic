(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{205:function(t,a,e){"use strict";e.r(a);var s={data:function(){return{url:"utilisateurs",validationErrors:null,ville_search:null,utilisateurs:[],utilisateur_id:null,utilisateur_codes:null,utilisateur_password:null,villes:[],utilisateur:{id:null,nom:null,prenom:null,tel:null,image:null,image_url:null,ville_id:null,cni:null,fonction:null,enabled:null,code_retour:null,password_retour:null,email:null},password:{actuel:null,nouveau:null,confirmation:null},edit:!1}},mounted:function(){new KTImageInput("kt_user_edit_avatar");this.$route.query.add&&$("#modal_form_utilisateur").modal("toggle")},created:function(){this.fetch()},methods:{fetch:function(t){var a={};this.ville_search&&(a.ville_search=this.ville_search),axios.get(this.url,{params:a}).then(function(t){this.utilisateurs=t.data.utilisateurs,t.data.villes&&(this.villes=t.data.villes,this.ville_search=this.villes[0].value)}.bind(this)).catch((function(t){return console.log(t)}))},modalPassword:function(t){this.utilisateur_password=t},savePassword:function(){var t=this,a={};$.each(this.password,(function(t,e){a[t]=e})),a.id=this.utilisateur_password.id,axios.post("utilisateurs/change_password",a).then((function(a){t.validationErrors=null,$("#modal_password").modal("toggle"),swal.fire("Votre mot de passe a été changé avec succès !","","success")})).catch((function(a){422==a.response.status&&(t.validationErrors=a.response.data.errors)}))},deleteUtilisateur:function(t){swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"question",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(function(a){var e=this;a.value&&axios.delete(this.url+t).then((function(t){swal.fire("Deleted!","Your file has been deleted.","success"),e.fetch()})).catch((function(t){return console.log(t)}))}.bind(this))},sendPassword:function(t){swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"question",showCancelButton:!0,confirmButtonText:"Oui !"}).then(function(a){var e=this;if(a.value){var s={};s.utilisateur=t,axios.get(this.url+"/password",{params:s}).then((function(t){swal.fire("Email envoyé !","Merci de consulter votre boite email, un email vous a été envoyé, contenant votre nouveau mot de passe.","success"),e.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},save:function(){var t=this,a=new FormData;$.each(this.utilisateur,(function(t,e){a.append(t,e||"")})),axios.post(this.url,a,{headers:{"content-type":"multipart/form-data"}}).then((function(a){t.clearForm(),$("#modal_form_utilisateur").modal("toggle"),t.fetch()})).catch((function(a){422==a.response.status&&(t.validationErrors=a.response.data.errors)}))},saveCompetences:function(){var t=this,a={};a.utilisateur=this.utilisateur_id,a.competences=this.utilisateur_competences,axios.post(this.url+"/competences",a).then((function(a){$("#modal_form_competences").modal("toggle"),t.fetch()})).catch((function(a){422==a.response.status&&(t.validationErrors=a.response.data.errors)}))},addUtilisateur:function(){this.clearForm(),this.validationErrors=null;new KTImageInput("kt_user_edit_avatar")},codesRetour:function(t){this.utilisateur_codes=t},editUtilisateur:function(t){$("#modal_form_utilisateur").modal("toggle"),this.validationErrors=null,this.edit=!0;new KTImageInput("kt_user_edit_avatar");$.each(this.utilisateur,function(a,e){this.utilisateur[a]=t[a]}.bind(this))},utilisateurCompetences:function(t){this.validationErrors=null,this.edit=!0,this.utilisateur_id=t.id,this.utilisateur_competences=t.competences},clearForm:function(){this.edit=!1,$.each(this.utilisateur,function(t,a){this.utilisateur[t]=null}.bind(this))},onImageChange:function(t){this.utilisateur.image=t.target.files[0]}}},i=e(4),l=Object(i.a)(s,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[e("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[e("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[e("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v("Equipe ASMEX")]),t._v(" "),e("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[e("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v(t._s(t.utilisateurs.length)+" Utilisateurs")])])]),t._v(" "),e("div",{staticClass:"d-flex align-items-center"},[e("a",{staticClass:"btn btn-primary btn-sm",attrs:{"data-toggle":"modal",href:"#modal_form_utilisateur"},on:{click:function(a){return t.addUtilisateur()}}},[e("i",{staticClass:"ki ki-plus icon-1x"}),t._v("Ajouter un utilisateur\n        ")])])])]),t._v(" "),e("div",{staticClass:"d-flex flex-column-fluid"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},t._l(t.utilisateurs,(function(a){return e("div",{key:a.id,staticClass:"col-xl-3 col-lg-6 col-md-6 col-sm-6"},[e("div",{staticClass:"card card-custom gutter-b card-stretch"},[e("div",{staticClass:"card-body pt-4"},[e("div",{staticClass:"d-flex justify-content-end"},[e("div",{staticClass:"dropdown dropdown-inline",attrs:{"data-toggle":"tooltip",title:"","data-placement":"left","data-original-title":"Quick actions"}},[t._m(0,!0),t._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-md dropdown-menu-right"},[e("ul",{staticClass:"navi navi-hover"},[t._m(1,!0),t._v(" "),e("li",{staticClass:"navi-separator mb-3 opacity-70"}),t._v(" "),e("li",{staticClass:"navi-item"},[e("a",{staticClass:"navi-link",on:{click:function(e){return t.editUtilisateur(a)}}},[t._m(2,!0)])]),t._v(" "),2==t.$auth.user().role_id?e("li",{staticClass:"navi-item"},[e("a",{staticClass:"navi-link",attrs:{"data-toggle":"modal",href:"#modal_codes_retour"},on:{click:function(e){return t.codesRetour(a)}}},[t._m(3,!0)])]):t._e(),t._v(" "),e("li",{staticClass:"navi-item"},[e("a",{staticClass:"navi-link",attrs:{"data-toggle":"modal",href:"#modal_password"},on:{click:function(e){return t.modalPassword(a)}}},[t._m(4,!0)])]),t._v(" "),e("li",{staticClass:"navi-item"},[e("a",{staticClass:"navi-link",on:{click:function(e){return t.deleteUtilisateur(a.id)}}},[t._m(5,!0)])])])])])]),t._v(" "),e("div",{staticClass:"d-flex align-items-end mb-7"},[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"flex-shrink-0 mr-4 mt-lg-0 mt-3"},[e("div",{staticClass:"symbol symbol-circle symbol-lg-75"},[e("img",{staticClass:"kt-widget__img kt-hidden-",attrs:{src:a.image_url,alt:"image"}})])]),t._v(" "),e("div",{staticClass:"d-flex flex-column"},[e("a",{staticClass:"text-dark font-weight-bold text-hover-primary font-size-h4 mb-0",attrs:{href:"#"}},[t._v(t._s(a.nom)+" "+t._s(a.prenom))]),t._v(" "),a.enabled?e("span",{staticClass:"label label-inline label-lg label-light-success font-weight-bold mt-1"},[t._v("Actif")]):t._e(),t._v(" "),a.enabled?t._e():e("span",{staticClass:"label label-inline label-lg label-light-danger font-weight-bold mt-1"},[t._v("Inactif")])])])]),t._v(" "),e("p",{staticClass:"mb-7"}),t._v(" "),e("div",{staticClass:"mb-7 mt-20"},[e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Email :")]),t._v(" "),e("a",{staticClass:"text-muted text-hover-primary",attrs:{href:"#"}},[t._v(t._s(a.email))])]),t._v(" "),e("div",{staticClass:"d-flex justify-content-between align-items-cente my-1"},[e("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Tél. :")]),t._v(" "),e("a",{staticClass:"text-muted text-hover-primary",attrs:{href:"#"}},[t._v(t._s(a.tel))])])])])])])})),0)])]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modal_form_utilisateur",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[t.utilisateur.id?t._e():e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Ajouter un membre d'équipe")]),t._v(" "),t.utilisateur.id?e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Modifier un membre d'équipe")]):t._e(),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})]),t._v(" "),e("form",{staticClass:"mb-3",on:{submit:function(a){return a.preventDefault(),t.save(a)}}},[e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group mt-2 text-center"},[e("div",{staticClass:"image-input image-input-empty image-input-outline",style:{"background-image":"url("+t.utilisateur.image_url+")"},attrs:{id:"kt_user_edit_avatar"}},[e("div",{staticClass:"image-input-wrapper"}),t._v(" "),e("label",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"change","data-toggle":"tooltip",title:"","data-original-title":"Change avatar"}},[e("i",{staticClass:"fa fa-pen icon-sm text-muted"}),t._v(" "),e("input",{attrs:{type:"file",name:"profile_avatar",accept:".png, .jpg, .jpeg, .svg"},on:{change:t.onImageChange}}),t._v(" "),e("input",{attrs:{type:"hidden",name:"profile_avatar_remove"}})]),t._v(" "),t._m(6),t._v(" "),t._m(7)])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Nom")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.nom,expression:"utilisateur.nom"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Nom"},domProps:{value:t.utilisateur.nom},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"nom",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Prénom")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.prenom,expression:"utilisateur.prenom"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Prénom"},domProps:{value:t.utilisateur.prenom},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"prenom",a.target.value)}}})])])]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("GSM")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.tel,expression:"utilisateur.tel"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"GSM"},domProps:{value:t.utilisateur.tel},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"tel",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Email")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.email,expression:"utilisateur.email"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Emaill"},domProps:{value:t.utilisateur.email},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"email",a.target.value)}}})])])]),t._v(" "),1==t.$auth.user().role_id?e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("CNIE")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.cni,expression:"utilisateur.cni"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"CNIE"},domProps:{value:t.utilisateur.cni},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"cni",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Fonction")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.fonction,expression:"utilisateur.fonction"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Fonction"},domProps:{value:t.utilisateur.fonction},on:{input:function(a){a.target.composing||t.$set(t.utilisateur,"fonction",a.target.value)}}})])])]):t._e(),t._v(" "),e("div",{staticClass:"form-group mb-0"},[e("div",{staticClass:"checkbox-inline mb-2"},[e("label",{staticClass:"checkbox checkbox-lg"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.utilisateur.enabled,expression:"utilisateur.enabled"}],attrs:{type:"checkbox",name:"enabled"},domProps:{checked:Array.isArray(t.utilisateur.enabled)?t._i(t.utilisateur.enabled,null)>-1:t.utilisateur.enabled},on:{change:function(a){var e=t.utilisateur.enabled,s=a.target,i=!!s.checked;if(Array.isArray(e)){var l=t._i(e,null);s.checked?l<0&&t.$set(t.utilisateur,"enabled",e.concat([null])):l>-1&&t.$set(t.utilisateur,"enabled",e.slice(0,l).concat(e.slice(l+1)))}else t.$set(t.utilisateur,"enabled",i)}}}),t._v(" "),e("span"),t._v("Son compte est-il actif ?\n                ")])])]),t._v(" "),t.validationErrors?e("validation-errors",{attrs:{errors:t.validationErrors}}):t._e()],1),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(a){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modal_password",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(8),t._v(" "),e("form",{staticClass:"mb-3",on:{submit:function(a){return a.preventDefault(),t.savePassword(a)}}},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-2"}),t._v(" "),e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-form-label col-3 text-lg-right text-left"},[t._v("Nouveau mot de passe :")]),t._v(" "),e("div",{staticClass:"col-9 pt-0 pb-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.password.nouveau,expression:"password.nouveau"}],staticClass:"form-control form-control-lg form-control-solid",attrs:{type:"password",placeholder:"Nouveau mot de passe"},domProps:{value:t.password.nouveau},on:{input:function(a){a.target.composing||t.$set(t.password,"nouveau",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-form-label col-3 text-lg-right text-left"},[t._v("Confirmer")]),t._v(" "),e("div",{staticClass:"col-9 pt-0 pb-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.password.confirmation,expression:"password.confirmation"}],staticClass:"form-control form-control-lg form-control-solid",attrs:{type:"password",placeholder:"Confirmer"},domProps:{value:t.password.confirmation},on:{input:function(a){a.target.composing||t.$set(t.password,"confirmation",a.target.value)}}})])])])]),t._v(" "),t.validationErrors?e("validation-errors",{attrs:{errors:t.validationErrors}}):t._e()],1),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(a){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modal_codes_retour",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-sm",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(9),t._v(" "),e("div",{staticClass:"modal-body"},[t.utilisateur_codes?e("div",{staticClass:"alert alert-custom alert-secondary mb-0",attrs:{role:"alert"}},[e("div",{staticClass:"alert-text"},[e("p",[e("b",[t._v("Code retour :")]),t._v("\n                "+t._s(t.utilisateur_codes.code_retour)+"\n              ")]),t._v(" "),e("p",{staticClass:"mb-0"},[e("b",[t._v("Mot de passe :")]),t._v("\n                "+t._s(t.utilisateur_codes.password_retour)+"\n              ")])])]):t._e()]),t._v(" "),t._m(10)])])])])}),[function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"btn btn-clean btn-hover-light-primary btn-sm btn-icon",attrs:{href:"#","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[a("i",{staticClass:"ki ki-bold-more-hor"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("li",{staticClass:"navi-header font-weight-bold py-4"},[a("span",{staticClass:"font-size-lg"},[this._v("Actions :")]),this._v(" "),a("i",{staticClass:"flaticon2-information icon-md text-muted",attrs:{"data-toggle":"tooltip","data-placement":"right",title:"","data-original-title":"Click to learn more..."}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"navi-text"},[a("i",{staticClass:"flaticon2-edit"}),this._v(" "),a("span",{staticClass:"ml-2"},[this._v("Modifier")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"navi-text"},[a("i",{staticClass:"flaticon-security"}),this._v(" "),a("span",{staticClass:"ml-2"},[this._v("Codes de retour")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"navi-text"},[a("i",{staticClass:"flaticon-security"}),this._v(" "),a("span",{staticClass:"ml-2"},[this._v("Mot de passe")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"navi-text"},[a("i",{staticClass:"flaticon2-rubbish-bin-delete-button"}),this._v(" "),a("span",{staticClass:"ml-2"},[this._v("Supprimer")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"cancel","data-toggle":"tooltip",title:"Cancel avatar"}},[a("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"remove","data-toggle":"tooltip",title:"Remove avatar"}},[a("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[this._v("Changer le mot de passe")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[this._v("Codes de retour")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("i",{staticClass:"ki ki-close",attrs:{"aria-hidden":"true"}})])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[this._v("Fermer")])])}],!1,null,null,null);a.default=l.exports}}]);