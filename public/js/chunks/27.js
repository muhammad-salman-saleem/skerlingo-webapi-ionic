(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{204:function(t,a,e){"use strict";e.r(a);var i=e(23),s=e.n(i),l=e(2),n={components:{"vue-dropify":s.a,TiptapVuetify:l.o},data:function(){return{url:"actualites",search:"",headers:[{text:"Titre",align:"middle",value:"label"},{text:"Brève description",align:"middle",value:"intro"},{text:"Date",align:"middle",value:"date_format"},{text:"",align:"right",value:"actions",sortable:!1}],validationErrors:null,actualites:[],metiers:[],villes:[],actualite:{id:null,label:null,image:null,intro:null,description:null,enabled:null,date:(new Date).toISOString().substr(0,10),image_url:null},edit:!1,menu1:!1,extensions:[l.g,l.a,l.j,l.q,l.n,l.i,l.k,l.c,l.l,[l.f,{options:{levels:[1,2,3]}}],l.b,l.d,l.h,l.m,l.e]}},computed:{_headers:function(){return this.headers.filter((function(t){return!t.hide}))}},created:function(){this.fetch()},methods:{fetch:function(t){axios.get(this.url).then(function(t){this.actualites=t.data.actualites,this.metiers=t.data.metiers,this.villes=t.data.villes}.bind(this)).catch((function(t){return console.log(t)}))},deleteActualite:function(t){swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"question",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(function(a){var e=this;a.value&&axios.delete(this.url+"/"+t).then((function(t){swal.fire("Deleted!","Your file has been deleted.","success"),e.fetch()})).catch((function(t){return console.log(t)}))}.bind(this))},saveActualite:function(){var t=this,a=new FormData;$.each(this.actualite,(function(t,e){a.append(t,e)})),axios.post(this.url,a,{headers:{"content-type":"multipart/form-data"}}).then((function(a){t.clearForm(),$("#modal_form_actualite").modal("toggle"),t.fetch()})).catch((function(a){422==a.response.status&&(t.validationErrors=a.response.data.errors)}))},addActualite:function(){this.clearForm(),this.validationErrors=null},editActualite:function(t){$("#modal_form_actualite").modal("toggle"),this.validationErrors=null,this.edit=!0,$.each(this.actualite,function(a,e){this.actualite[a]=t[a]}.bind(this))},clearForm:function(){this.edit=!1,$.each(this.actualite,function(t,a){this.actualite[t]=null}.bind(this))},onImageChange:function(t){this.actualite.image=t[0]}}},r=e(4),o=Object(r.a)(n,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[e("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[e("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[e("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v("Actualités")]),t._v(" "),e("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[e("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v(t._s(t.actualites.length)+" actualites")]),t._v(" "),e("form",{staticClass:"ml-5"},[e("div",{staticClass:"input-group input-group-sm input-group-solid",staticStyle:{"max-width":"175px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Recherche..."},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}}),t._v(" "),e("div",{staticClass:"input-group-append"},[e("span",{staticClass:"input-group-text"},[e("span",{staticClass:"svg-icon"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"}},[e("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[e("rect",{attrs:{x:"0",y:"0",width:"24",height:"24"}}),t._v(" "),e("path",{attrs:{d:"M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z",fill:"#000000","fill-rule":"nonzero",opacity:"0.3"}}),t._v(" "),e("path",{attrs:{d:"M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z",fill:"#000000","fill-rule":"nonzero"}})])])])])])])])])]),t._v(" "),e("div",{staticClass:"d-flex align-items-center"},[e("a",{staticClass:"btn btn-primary btn-sm",attrs:{"data-toggle":"modal",href:"#modal_form_actualite"},on:{click:function(a){return t.addActualite()}}},[e("i",{staticClass:"ki ki-plus icon-1x"}),t._v("Ajouter une actualité\n        ")])])])]),t._v(" "),e("div",{staticClass:"d-flex flex-column-fluid"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"card card-custom gutter-b"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body p-5 pt-0"},[e("v-card",{staticStyle:{"box-shadow":"none"}},[e("v-data-table",{staticClass:"table",attrs:{headers:t._headers,items:t.actualites,search:t.search},scopedSlots:t._u([{key:"item.label",fn:function(a){var i=a.item;return[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"symbol symbol-60 symbol-light-success mr-2"},[e("img",{attrs:{src:i.image_url,alt:""}})]),t._v(" "),e("div",{staticClass:"d-flex flex-column flex-grow-1"},[e("a",{staticClass:"text-dark text-hover-primary font-weight-bold",attrs:{href:"#"}},[t._v(t._s(i.label))])])])]}},{key:"item.intro",fn:function(a){var i=a.item;return[e("small",{},[t._v(t._s(i.intro))])]}},{key:"item.date_format",fn:function(a){var i=a.item;return[e("span",{staticClass:"label label-lg label-light-dark label-inline font-weight-normal"},[t._v(t._s(i.date_format))])]}},{key:"item.actions",fn:function(a){var i=a.item;return[e("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:"#"},on:{click:function(a){return t.editActualite(i)}}},[e("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[e("i",{staticClass:"flaticon-edit"})])]),t._v(" "),e("a",{staticClass:"btn btn-icon btn-light btn-sm",attrs:{href:"#"}},[e("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[e("i",{staticClass:"flaticon-delete"})])])]}}])})],1)],1)])])]),t._v(" "),e("div",{staticClass:"modal fade",attrs:{id:"modal_form_actualite",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[t.actualite.id?t._e():e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Ajouter une actualité")]),t._v(" "),t.actualite.id?e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Modifier une actualité")]):t._e(),t._v(" "),t._m(1)]),t._v(" "),e("form",{staticClass:"mb-3",on:{submit:function(a){return a.preventDefault(),t.saveActualite(a)}}},[e("div",{staticClass:"modal-body"},[t.validationErrors?e("validation-errors",{attrs:{errors:t.validationErrors}}):t._e(),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Titre :")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.actualite.label,expression:"actualite.label"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Titre"},domProps:{value:t.actualite.label},on:{input:function(a){a.target.composing||t.$set(t.actualite,"label",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group mb-0"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Brève description :")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.actualite.intro,expression:"actualite.intro"}],staticClass:"form-control",attrs:{rows:"2"},domProps:{value:t.actualite.intro},on:{input:function(a){a.target.composing||t.$set(t.actualite,"intro",a.target.value)}}})])])]),t._v(" "),e("div",{staticClass:"form-group mt-2"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Date de publication")]),t._v(" "),e("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on,s=a.attrs;return[e("v-text-field",t._g(t._b({staticClass:"date_picker_text",attrs:{"persistent-hint":""},on:{blur:function(a){t.actualite.date=t.actualite.date}},model:{value:t.actualite.date,callback:function(a){t.$set(t.actualite,"date",a)},expression:"actualite.date"}},"v-text-field",s,!1),i))]}}]),model:{value:t.menu1,callback:function(a){t.menu1=a},expression:"menu1"}},[t._v(" "),e("v-date-picker",{attrs:{"no-title":""},on:{input:function(a){t.menu1=!1}},model:{value:t.actualite.date,callback:function(a){t.$set(t.actualite,"date",a)},expression:"actualite.date"}})],1)],1),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"checkbox-list"},[e("label",{staticClass:"checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.actualite.enabled,expression:"actualite.enabled"}],attrs:{type:"checkbox",name:"enabled"},domProps:{checked:Array.isArray(t.actualite.enabled)?t._i(t.actualite.enabled,null)>-1:t.actualite.enabled},on:{change:function(a){var e=t.actualite.enabled,i=a.target,s=!!i.checked;if(Array.isArray(e)){var l=t._i(e,null);i.checked?l<0&&t.$set(t.actualite,"enabled",e.concat([null])):l>-1&&t.$set(t.actualite,"enabled",e.slice(0,l).concat(e.slice(l+1)))}else t.$set(t.actualite,"enabled",s)}}}),t._v(" "),e("span"),t._v(" Afficher l'actualité pour les clients ?\n                ")])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Détails :")]),t._v(" "),e("tiptap-vuetify",{attrs:{extensions:t.extensions},model:{value:t.actualite.description,callback:function(a){t.$set(t.actualite,"description",a)},expression:"actualite.description"}})],1),t._v(" "),e("div",{staticClass:"form-group mt-2 text-center"},[e("vue-dropify",{attrs:{accept:".png, .jpg, .jpeg, .svg"},on:{upload:t.onImageChange}})],1)],1),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(a){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])])])}),[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("div",{staticClass:"card-title"},[a("h3",{staticClass:"card-label"},[this._v("Liste des Actualités")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("i",{staticClass:"ki ki-close",attrs:{"aria-hidden":"true"}})])}],!1,null,null,null);a.default=o.exports}}]);