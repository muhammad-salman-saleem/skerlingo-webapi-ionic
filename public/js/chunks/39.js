(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{212:function(t,e,s){"use strict";s.r(e);function a(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var i={data:function(){var t;return a(t={url:"rfqs/"+(this.$route.params.id?this.$route.params.id:""),optionsScroll:{height:"350px",allowPageScroll:!0,size:"5px",start:"bottom"},headers:[{text:"RFQ",align:"middle",value:"importer_label"}],headers_entreprises:[{text:"Entreprise",align:"middle",value:"entreprise_label"},{text:"Envoi",align:"middle",value:"sent"},{text:"Date",align:"middle",value:"date_human"},{text:"",align:"right",value:"actions",sortable:!1}],headers_entreprises_messagerie:[{text:"Exporter",align:"middle",value:"entreprise_label"},{text:"Messages",align:"middle",value:"messages_count"},{text:"Date",align:"middle",value:"date_human"},{text:"",align:"right",value:"actions",sortable:!1}],search:"",validationErrors:null,rfq_entreprise:null,page_title:null,message_text:null,message_files:null,rfq:[],rfqs:[],rfq_entreprises:[],rfq_proposals:[],messages:[],contact_entreprise:null,trakings:[],entites:[],statuts:[]},"rfq",null),a(t,"traking",{id:null,rfq_id:null,statut_id:null,commentaire:null}),a(t,"filter",{date:moment().startOf("year").format("Y-MM-DD")+" - "+moment().endOf("year").format("Y-MM-DD"),rfq_product:null,statut:null,code:null,partenaire:null}),a(t,"publish_request",{imediat:null,imediat_ids:[],after_24h:null,after_24h_ids:[],after_48h:null,after_48h_ids:[],publish_online:null,rfq_id:null}),a(t,"edit",!1),t},mounted:function(){setTimeout(function(){KTAppChat.init()}.bind(this),1e3)},computed:{_headers:function(){return this.headers.filter((function(t){return!t.hide}))},_headers_entreprises:function(){return this.headers_entreprises.filter((function(t){return!t.hide}))},_headers_entreprises_messagerie:function(){return this.headers_entreprises_messagerie.filter((function(t){return!t.hide}))}},created:function(){this.$route.query.product||this.rfq&&this.rfq.entreprise_id?(this.filter.rfq_product=!0,1==this.$auth.user().role_id?this.page_title="Product/service requests":2==this.$auth.user().role_id?this.page_title="RFQs - From your Catalog":this.page_title="My Requests for Quotation"):1==this.$auth.user().role_id?this.page_title="Direct requests":2==this.$auth.user().role_id?this.page_title="RFQ - From skerlingo":this.page_title="My Requests for Quotation",this.fetch()},methods:{fetch:function(t){if(this.rfq&&t&&this.rfq.id==t)return!1;this.$route.query.rcode?(this.filter.code=this.$route.query.rcode,this.url="rfqs/rcode"):t?this.url="rfqs/"+t:this.$route.params.id||this.$router.push({path:"/rfqs"});var e={};$.each(this.filter,(function(t,s){e[t]=s})),axios.get(t?"rfqs/"+t:this.url,{params:e}).then(function(t){this.rfq=t.data.rfq,t.data.trakings&&(this.trakings=t.data.trakings),t.data.statuts&&(this.statuts=t.data.statuts),this.rfqs=t.data.rfqs,t.data.rfq_entreprises&&(this.rfq_entreprises=t.data.rfq_entreprises),t.data.rfq_proposals&&(this.rfq_proposals=t.data.rfq_proposals,1==this.rfq_proposals.length?this.rfq_entreprise=this.rfq_proposals[0]:0==this.rfq_proposals.length&&(this.rfq_entreprise=null)),t.data.entites&&(this.entites=t.data.entites),this.rfq_entreprise?this.get_messages(this.rfq_entreprise.id):this.messages=[],this.rfq&&this.rfq.entreprise_id?(this.filter.rfq_product=!0,1==this.$auth.user().role_id?this.page_title="Product/service requests":2==this.$auth.user().role_id?this.page_title="RFQs - From your Catalog":this.page_title="My Requests for Quotation"):1==this.$auth.user().role_id?this.page_title="Direct requests":2==this.$auth.user().role_id?this.page_title="RFQ - From skerlingo":this.page_title="My Requests for Quotation"}.bind(this)).catch((function(t){return console.log(t)}))},get_messages:function(t){axios.get("rfqs/get_messages?id="+t).then(function(t){this.messages=t.data.messages,this.contact_entreprise=t.data.contact_entreprise}.bind(this)).catch((function(t){return console.log(t)}))},trakingForm:function(){var t=this;this.traking.rfq_id=this.rfq.id;var e=new FormData;$.each(this.traking,(function(t,s){e.append(t,s)})),axios.post("rfqs/traking_form",e,{headers:{"content-type":"multipart/form-data"}}).then((function(e){t.clearForm(),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},saveEntreprises:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s={};$.each(this.publish_request,(function(t,e){s[t]=e})),e&&(s.approuver_entreprise_product=!0),s.rfq_id=this.rfq.id,axios.post("rfqs/save_entreprises",s).then((function(s){e||$("#modal_form_approuver").modal("toggle"),t.publish_request.imediat_ids=[],t.publish_request.after_24h_ids=[],t.publish_request.after_48h_ids=[],t.clearForm(),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},change_statut:function(t,e){swal.fire({title:"Êtes-vous sûr ?",text:"refuser"==e?"Vous êtes sur le point de refuser cette RFQ !":"Vous êtes sur le point d'approuver cette RFQ !",type:"question",showCancelButton:!0,confirmButtonText:"refus"==e?"Refuser":"Approuver",cancelButtonText:"Annuler"}).then(function(s){var a=this;if(s.value){var i={};i.id=t,i.type=e,axios.get("rfqs/change_statut",{params:i}).then((function(t){swal.fire(t.data.title,t.data.message,"success"),a.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},send_message:function(t){var e=this;t.target.disabled=!0,t.target.classList.toggle("spinner");var s=new FormData;s.append("rfq_entreprise_id",this.rfq_entreprise.id),s.append("rfq_id",this.rfq.id),s.append("entreprise_id",this.rfq_entreprise.entreprise_id),s.append("message",this.message_text),$.each(this.message_files,(function(t,e){s.append("files[]",e)})),axios.post("rfqs/send_message",s,{headers:{"content-type":"multipart/form-data"}}).then((function(s){e.message_text=null,e.message_files=[],t.target.disabled=!1,t.target.classList.toggle("spinner"),e.clearForm(),e.fetch()})).catch((function(t){422==t.response.status&&(e.validationErrors=t.response.data.errors)}))},publier_rfq:function(){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de publier cette demande sur le site !",type:"question",showCancelButton:!0,confirmButtonText:"Publier"}).then(function(t){var e=this;if(t.value){var s={};s.id=this.rfq.id,s.publish=!0,axios.post("rfqs/published",s).then((function(t){swal.fire("La Demande est maintenant publiée sur le site.","","success"),e.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},close_rfq:function(){swal.fire({title:"Are you sure ?",text:"You are about to close this request !",type:"question",showCancelButton:!0,confirmButtonText:"Close the request"}).then(function(t){var e=this;if(t.value){var s={};s.id=this.rfq.id,s.close=!0,axios.post("rfqs/published",s).then((function(t){swal.fire("The Request has been closed.","","success"),e.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},retirer_rfq:function(t){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de retirer cette demande de la plateforme !",type:"question",showCancelButton:!0,confirmButtonText:"Retirer"}).then(function(t){var e=this;if(t.value){var s={};s.id=this.rfq.id,s.publish=!1,axios.post("rfqs/published",s).then((function(t){e.$root.$refs.AdminSideBar.fetch(),swal.fire("La Demande à été retirée de  la plateforme.","","success"),e.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},clearForm:function(){this.edit=!1,$.each(this.traking,function(t,e){this.traking[t]=null}.bind(this))},show_messages:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.rfq_entreprise=t,this.get_messages(this.rfq_entreprise.id)},deleteRfq:function(t){swal.fire({title:"Êtes-vous sûr ?",text:"Vous êtes sur le point de supprimer cette demande !",type:"question",showCancelButton:!0,confirmButtonText:"Supprimer",cancelButtonText:"Annuler"}).then(function(e){var s=this;e.value&&axios.post("rfqs/"+t,{_method:"DELETE"}).then((function(t){s.url="rfqs/",s.fetch(),swal.fire("Rfq supprimé !","Le demande a été supprimée avec succés.","success")})).catch((function(t){return console.log(t)}))}.bind(this))}}},r=s(4),l=Object(r.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[s("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[s("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[s("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v(t._s(t.page_title))]),t._v(" "),s("div",{staticClass:"subheader-separator subheader-separator-ver mt-2 mb-2 mr-5 bg-gray-200"}),t._v(" "),s("ul",{staticClass:"breadcrumb breadcrumb-transparent breadcrumb-dot font-weight-bold p-0 my-2 mr-3 font-size-sm"},[s("li",{staticClass:"breadcrumb-item"},[s("router-link",{staticClass:"text-muted",attrs:{to:"/rfqs"}},[t._v("Requests")])],1)]),t._v(" "),t.rfq?s("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[s("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v("#"+t._s(t.rfq.id))])]):t._e()])])]),t._v(" "),s("div",{staticClass:"d-flex flex-column-fluid"},[s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"d-flex flex-row"},[t._e(),t._v(" "),t.rfq?s("div",{staticClass:"flex-row-fluid ml-lg-8s",attrs:{id:"kt_chat_content"}},[3!=t.$auth.user().role_id?s("div",{staticClass:"card card-custom gutter-b"},[s("div",{staticClass:"card-body py-4"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"flex-shrink-0 mr-7"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{attrs:{src:t.rfq.importer_image,alt:""}}),t._v(" "),t.rfq.importer_pays_flag?s("img",{staticStyle:{width:"30px",height:"auto","max-width":"initial","border-radius":"0",position:"absolute",right:"-5px",bottom:"-5px"},attrs:{src:t.rfq.importer_pays_flag,alt:""}}):t._e()])]),t._v(" "),s("div",{staticClass:"flex-grow-1"},[s("div",{staticClass:"d-flex align-items-center justify-content-between flex-wrap"},[s("div",{staticClass:"mr-3"},[s("div",{staticClass:"d-flex align-items-center mr-3"},[s("a",{staticClass:"d-flex align-items-center text-dark text-hover-primary font-size-h5 font-weight-bold mr-3",attrs:{href:"#"}},[t._v(t._s(t.rfq.importer_label))]),t._v(" "),1==t.$auth.user().role_id?s("span",{staticClass:"label label-light-success label-inline font-weight-bolder mr-1"},[t._v("Compte actif")]):t._e()]),t._v(" "),s("div",{staticClass:"mt-2"},[s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-1 px-0 font-size-sm"},[t._m(0),t._v("\n                          "+t._s(t.rfq.importer_email)+"\n                        ")]),t._v(" "),s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-1 px-0 font-size-sm"},[t._m(1),t._v("\n                          "+t._s(t.rfq.importer_tel)+"\n                        ")]),t._v(" "),1==t.$auth.user().role_id?s("br"):t._e(),t._v(" "),1==t.$auth.user().role_id?s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm"},[t._m(2),t._v("\n                          Member since : "+t._s(t.rfq.importer_since)+"\n                        ")]):t._e(),t._v(" "),s("br"),t._v(" "),s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm mt-1"},[t._m(3),t._v("\n                          "+t._s(t.rfq.importer_company)+"\n                        ")]),t._v(" "),s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm mt-1"},[t._m(4),t._v("\n                          "+t._s(t.rfq.importer_pays_label)+"\n                        ")])])])])]),t._v(" "),t.rfq.produit_label?s("div",{staticClass:"flex-shrink-0"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{staticClass:"m-auto",attrs:{src:t.rfq.produit_image,alt:""}}),t._v(" "),s("span",{staticClass:"d-block text-center font-size-xs text-dark max-w-90px font-weight-bold mt-1"},[t._v(t._s(t.rfq.produit_label))])])]):t._e(),t._v(" "),t.rfq.produit_label?t._e():s("div",{staticClass:"flex-shrink-0"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{staticClass:"m-auto",attrs:{src:t.rfq.secteur_image,alt:""}}),t._v(" "),s("span",{staticClass:"d-block text-center font-size-xs text-dark max-w-90px font-weight-bold mt-1"},[t._v(t._s(t.rfq.secteur_label))])])])])])]):t._e(),t._v(" "),3==t.$auth.user().role_id&&t.rfq.produit_label?s("div",{staticClass:"card card-custom gutter-b"},[s("div",{staticClass:"card-body py-4"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"flex-shrink-0 mr-7"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{attrs:{src:t.rfq.entreprise_image,alt:""}})])]),t._v(" "),s("div",{staticClass:"flex-grow-1"},[s("div",{staticClass:"d-flex align-items-center justify-content-between flex-wrap"},[s("div",{staticClass:"mr-3"},[s("div",{staticClass:"d-flex align-items-center mr-3"},[s("a",{staticClass:"d-flex align-items-center text-dark text-hover-primary font-size-h5 font-weight-bold mr-3",attrs:{href:"#"}},[t._v(t._s(t.rfq.entreprise_label))])]),t._v(" "),s("div",{staticClass:"mt-2"},[s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm mt-1"},[t._m(5),t._v("\n                          "+t._s(t.rfq.secteur_label)+"\n                        ")])])])])]),t._v(" "),t.rfq.produit_label?s("div",{staticClass:"flex-shrink-0"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{staticClass:"m-auto",attrs:{src:t.rfq.produit_image,alt:""}}),t._v(" "),s("span",{staticClass:"d-block text-center font-size-xs text-dark max-w-90px font-weight-bold mt-1"},[t._v(t._s(t.rfq.produit_label))])])]):t._e(),t._v(" "),t.rfq.produit_label?t._e():s("div",{staticClass:"flex-shrink-0"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{staticClass:"m-auto",attrs:{src:t.rfq.secteur_image,alt:""}}),t._v(" "),s("span",{staticClass:"d-block text-center font-size-xs text-dark max-w-90px font-weight-bold mt-1"},[t._v(t._s(t.rfq.secteur_label))])])])])])]):t._e(),t._v(" "),3==t.$auth.user().role_id&&!t.rfq.produit_label&&t.rfq_entreprise&&t.contact_entreprise?s("div",{staticClass:"card card-custom gutter-b"},[s("div",{staticClass:"card-body py-4"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"flex-shrink-0 mr-7"},[s("div",{staticClass:"symbol symbol-80 symbol-light-success mr-2"},[s("img",{attrs:{src:t.rfq_entreprise.entreprise_image,alt:""}})])]),t._v(" "),s("div",{staticClass:"flex-grow-1"},[s("div",{staticClass:"d-flex align-items-center justify-content-between flex-wrap"},[s("div",{staticClass:"mr-3"},[s("div",{staticClass:"d-flex align-items-center mr-3"},[s("a",{staticClass:"d-flex align-items-center text-dark text-hover-primary font-size-h5 font-weight-bold mr-3",attrs:{href:"#"}},[t._v(t._s(t.contact_entreprise.nomComplet))])]),t._v(" "),s("div",{staticClass:"mt-2"},[s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm mt-1"},[t._m(6),t._v("\n                          "+t._s(t.contact_entreprise.tel)+"\n                        ")]),t._v(" "),s("span",{staticClass:"btn btn-text-dark-50 pt-0 pb-0 px-0 font-size-sm mt-1 d-block"},[t._m(7),t._v("\n                          "+t._s(t.contact_entreprise.email)+"\n                        ")])])])])])])])]):t._e(),t._v(" "),s("div",{staticClass:"card card-custom"},[s("div",{staticClass:"card-header align-items-center px-4 py-3"},[s("div",{staticClass:"text-left flex-grow-1"},[s("div",{staticClass:"text-dark-75 font-weight-bold font-size-h5 mb-1"},[t._v(t._s(t.rfq.sujet))]),t._v(" "),s("span",{staticClass:"label label-inline font-weight-bold text-uppercase",style:{color:"#FFF","background-color":"rgb("+t.rfq.statut_color+")"}},[t._v(t._s(t.rfq.statut_label))]),t._v(" "),2!=t.$auth.user().role_id?s("span",[t.rfq.closed?s("span",{staticClass:"label label-dark label-inline font-weight-lighter mr-2",staticStyle:{"background-color":"#1B1464"}},[t._v("Clôturée")]):t._e(),t._v(" "),1!=t.$auth.user().role_id||t.rfq.published||t.rfq.produit_label?t._e():s("span",{staticClass:"label label-danger label-inline font-weight-lighter mr-2"},[t._v("UNPUBLISHED")]),t._v(" "),1==t.$auth.user().role_id&&t.rfq.published&&!t.rfq.produit_label?s("span",{staticClass:"label label-primary label-inline font-weight-lighter mr-2"},[t._v("PUBLISHED")]):t._e()]):t._e()]),t._v(" "),s("div",{staticClass:"text-right flex-grow-1"},[3!=t.$auth.user().role_id||t.rfq.closed||t.rfq.produit_id?t._e():s("button",{staticClass:"btn btn-dark btn-sm btn-icon-md",attrs:{type:"button"},on:{click:function(e){return t.close_rfq()}}},[s("i",{staticClass:"mr-2 flaticon-close icon-md"}),t._v("\n                  Close the request\n                ")]),t._v(" "),1==t.$auth.user().role_id?s("div",{staticClass:"dropdown dropdown-inline"},[t._m(8),t._v(" "),s("div",{staticClass:"dropdown-menu p-0 m-0 dropdown-menu-right dropdown-menu-md"},[s("ul",{staticClass:"navi navi-hover py-5 pl-0"},[1==t.rfq.statut_id?s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(e){return t.change_statut(t.rfq.id,"approuver")}}},[t._m(9),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Approuver la demande")])])]):t._e(),t._v(" "),1==t.rfq.statut_id?s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(e){return t.change_statut(t.rfq.id,"refuser")}}},[t._m(10),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Refuser la demande")])])]):t._e(),t._v(" "),0!=t.rfq_entreprises.length||t.rfq.entreprise_id||2!=t.rfq.statut_id?t._e():s("li",{staticClass:"navi-item"},[t._m(11)]),t._v(" "),!t.rfq_entreprises||t.rfq.produit_label||t.rfq.published||2!=t.rfq.statut_id?t._e():s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(e){return t.publier_rfq()}}},[t._m(12),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Publier sur le site")])])]),t._v(" "),(t.rfq_entreprises&&t.rfq.closed,t._e()),t._v(" "),t.rfq_entreprises.length>0&&t.rfq.published&&t.rfq.entreprise_id?s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(e){return t.retirer_rfq()}}},[t._m(14),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Retirer de la plateforme")])])]):t._e(),t._v(" "),t.rfq_entreprises.length>0&&!t.rfq.entreprise_id?s("li",{staticClass:"navi-item"},[t._m(15)]):t._e(),t._v(" "),t.rfq_entreprises?s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(e){return t.deleteRfq(t.rfq.id)}}},[t._m(16),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Supprimer")])])]):t._e()])])]):t._e()])]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{directives:[{name:"slimscroll",rawName:"v-slimscroll",value:t.optionsScroll,expression:"optionsScroll"}]},[!t.rfq_entreprise&&t.rfq_proposals.length>0?s("v-card",{staticStyle:{"box-shadow":"none"}},[s("v-data-table",{staticClass:"table no-td-rl-p",attrs:{"hide-default-footer":"",headers:t._headers_entreprises_messagerie,items:t.rfq_proposals},scopedSlots:t._u([{key:"item.entreprise_label",fn:function(e){var a=e.item;return[s("a",{on:{click:function(e){return t.show_messages(a)}}},[s("div",{staticClass:"d-flex align-items-center"},[s("div",{staticClass:"symbol symbol-50 symbol-light-success mr-2"},[s("img",{attrs:{src:a.entreprise_image,alt:""}})]),t._v(" "),s("div",{staticClass:"d-flex flex-column flex-grow-1"},[s("span",{staticClass:"text-dark text-hover-primary font-size-sm font-weight-bold"},[t._v(t._s(a.entreprise_label))])])])])]}},{key:"item.date_human",fn:function(e){var a=e.item;return[s("span",{staticClass:"d-block font-roboto"},[t._v(t._s(a.date_human))])]}},{key:"item.messages_count",fn:function(e){var a=e.item;return[s("a",{on:{click:function(e){return t.show_messages(a)}}},[s("span",{staticClass:"label label-lg label-inline font-weight-normal"},[t._v(t._s(a.messages_count))])])]}},{key:"item.actions",fn:function(e){var a=e.item;return[s("a",{staticClass:"btn btn-icon btn-light btn-sm",on:{click:function(e){return t.show_messages(a)}}},[s("span",{staticClass:"svg-icon svg-icon-md svg-icon-success"},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"}},[s("g",{attrs:{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[s("polygon",{attrs:{points:"0 0 24 0 24 24 0 24"}}),t._v(" "),s("rect",{attrs:{fill:"#000000",opacity:"0.5",transform:"translate(12.000000, 12.000000) rotate(-90.000000) translate(-12.000000, -12.000000)",x:"11",y:"5",width:"2",height:"14",rx:"1"}}),t._v(" "),s("path",{attrs:{d:"M9.70710318,15.7071045 C9.31657888,16.0976288 8.68341391,16.0976288 8.29288961,15.7071045 C7.90236532,15.3165802 7.90236532,14.6834152 8.29288961,14.2928909 L14.2928896,8.29289093 C14.6714686,7.914312 15.281055,7.90106637 15.675721,8.26284357 L21.675721,13.7628436 C22.08284,14.136036 22.1103429,14.7686034 21.7371505,15.1757223 C21.3639581,15.5828413 20.7313908,15.6103443 20.3242718,15.2371519 L15.0300721,10.3841355 L9.70710318,15.7071045 Z",fill:"#000000","fill-rule":"nonzero",transform:"translate(14.999999, 11.999997) scale(1, -1) rotate(90.000000) translate(-14.999999, -11.999997)"}})])])])])]}}],null,!1,3677191405)})],1):t._e(),t._v(" "),t.rfq_entreprise||0==t.rfq_proposals.length?s("div",{staticClass:"messages"},[t.rfq_proposals.length>1?s("a",{staticClass:"btn btn-text-dark-50 btn-icon-primary btn-hover-icon-danger font-weight-bold btn-hover-bg-light p-0 mb-5",attrs:{href:"#"},on:{click:function(e){return t.show_messages()}}},[s("i",{staticClass:"flaticon2-left-arrow mr-1"}),t._v("Retour\n                  ")]):t._e(),t._v(" "),s("div",{staticClass:"d-flex flex-column mb-5 align-items-start"},[s("div",{staticClass:"d-flex align-items-center"},[s("div",{staticClass:"symbol symbol-circle symbol-40 mr-3"},[t.rfq.importer_image?s("img",{attrs:{alt:"Pic",src:t.rfq.importer_image}}):t._e()]),t._v(" "),s("div",[s("a",{staticClass:"text-dark-75 text-hover-primary font-weight-bold font-size-sm",attrs:{href:"#"}},[t._v("\n                          "+t._s(t.rfq.importer_label)+"\n                          "),s("span",{staticClass:"d-block text-muted font-size-xs"},[t._v(t._s(t.rfq.date_human))])])])]),t._v(" "),s("div",{staticClass:"mt-2 rounded p-5 bg-light-success text-dark-50 font-size-sm text-left max-w-600px",staticStyle:{"white-space":"pre-line"}},[t._v(t._s(t.rfq.message))])]),t._v(" "),t._l(t.messages,(function(e){return s("div",{key:e.id,staticClass:"d-flex flex-column mb-5",class:{"align-items-start":!e.to_importer,"align-items-end":e.to_importer}},[e.to_importer?t._e():s("div",{staticClass:"d-flex align-items-center"},[s("div",{staticClass:"symbol symbol-circle symbol-40 mr-3"},[e.from_image?s("img",{attrs:{alt:"Pic",src:e.from_image}}):t._e()]),t._v(" "),s("div",[s("a",{staticClass:"text-dark-75 text-hover-primary font-weight-bold font-size-sm",attrs:{href:"#"}},[t._v("\n                          "+t._s(e.from_label)+"\n                          "),s("span",{staticClass:"d-block text-muted font-size-xs"},[t._v(t._s(e.date_human))])])])]),t._v(" "),e.to_importer?s("div",{staticClass:"d-flex align-items-center"},[s("div",[s("a",{staticClass:"text-dark-75 text-hover-primary font-weight-bold font-size-sm",attrs:{href:"#"}},[t._v("\n                          "+t._s(e.from_label)+"\n                          "),s("span",{staticClass:"d-block text-muted font-size-xs"},[t._v(t._s(e.date_human))])])]),t._v(" "),s("div",{staticClass:"symbol symbol-circle symbol-40 ml-3"},[e.from_image?s("img",{attrs:{alt:"Pic",src:e.from_image}}):t._e()])]):t._e(),t._v(" "),s("div",{staticClass:"mt-2 rounded p-5 text-dark-50 font-size-sm text-left max-w-600px",class:{"bg-light-success":!e.to_importer,"bg-light-primary":e.to_importer},staticStyle:{"white-space":"pre-line"}},[t._v("\n                      "+t._s(e.message)+"\n                      "),t._l(e.files_path,(function(e,a){return s("a",{key:e+a,staticClass:"label label-light-dark label-inline mr-2 mt-2",attrs:{href:e,download:""}},[t._v("Pièce jointe "+t._s(a+1))])}))],2)])}))],2):t._e()],1)]),t._v(" "),t.rfq_entreprise&&1!=t.$auth.user().role_id?s("div",{staticClass:"card-footer align-items-center"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message_text,expression:"message_text"}],staticClass:"form-control border-0 p-0",attrs:{rows:"4",placeholder:"Type a message"},domProps:{value:t.message_text},on:{input:function(e){e.target.composing||(t.message_text=e.target.value)}}}),t._v(" "),s("div",{staticClass:"d-flex align-items-center justify-content-between mt-5"},[s("div",{staticClass:"mr-3"},[s("v-file-input",{attrs:{multiple:"","small-chips":"","truncate-length":"13"},model:{value:t.message_files,callback:function(e){t.message_files=e},expression:"message_files"}}),t._v(" "),t._m(17)],1),t._v(" "),s("div",[s("button",{staticClass:"btn btn-primary btn-md spinner-light-success spinner-right text-uppercase font-weight-bold py-2 px-6",attrs:{disabled:!t.message_text,type:"button"},on:{click:function(e){return t.send_message(e)}}},[t._v("Send message")])])])]):t._e()])]):t._e()])])]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"modal_form_approuver",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(18),t._v(" "),s("form",{staticClass:"mb-3",on:{submit:function(e){return e.preventDefault(),t.saveEntreprises(!1)}}},[t._m(19),t._v(" "),s("div",{staticClass:"tab-content mt-5",attrs:{id:"myTabContent"}},[s("div",{staticClass:"tab-pane fade show active",attrs:{id:"kt_tab_pane_1",role:"tabpanel","aria-labelledby":"kt_tab_pane_2"}},[s("div",{staticClass:"modal-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"form-group mb-0 mt-3"},[s("div",{staticClass:"checkbox-inline"},[s("label",{staticClass:"checkbox checkbox-rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.publish_request.imediat,expression:"publish_request.imediat"}],attrs:{type:"checkbox",name:"Checkboxes15_1"},domProps:{checked:Array.isArray(t.publish_request.imediat)?t._i(t.publish_request.imediat,null)>-1:t.publish_request.imediat},on:{change:function(e){var s=t.publish_request.imediat,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=t._i(s,null);a.checked?r<0&&t.$set(t.publish_request,"imediat",s.concat([null])):r>-1&&t.$set(t.publish_request,"imediat",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.publish_request,"imediat",i)}}}),t._v(" "),s("span"),t._v("Send immediately to :\n                        ")])])])]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("div",{staticClass:"form-group mb-0"},[s("v-autocomplete",{attrs:{items:t.entites,"small-chips":"",disabled:!t.publish_request.imediat,clearable:"",multiple:"",dense:"",filled:""},model:{value:t.publish_request.imediat_ids,callback:function(e){t.$set(t.publish_request,"imediat_ids",e)},expression:"publish_request.imediat_ids"}})],1)])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"form-group mb-0 mt-3"},[s("div",{staticClass:"checkbox-inline"},[s("label",{staticClass:"checkbox checkbox-rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.publish_request.after_24h,expression:"publish_request.after_24h"}],attrs:{type:"checkbox",name:"Checkboxes15_1"},domProps:{checked:Array.isArray(t.publish_request.after_24h)?t._i(t.publish_request.after_24h,null)>-1:t.publish_request.after_24h},on:{change:function(e){var s=t.publish_request.after_24h,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=t._i(s,null);a.checked?r<0&&t.$set(t.publish_request,"after_24h",s.concat([null])):r>-1&&t.$set(t.publish_request,"after_24h",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.publish_request,"after_24h",i)}}}),t._v(" "),s("span"),t._v("Send after 24H :\n                        ")])])])]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("div",{staticClass:"form-group mb-0"},[s("v-autocomplete",{attrs:{items:t.entites,disabled:!t.publish_request.after_24h,"small-chips":"",clearable:"",multiple:"",dense:"",filled:""},model:{value:t.publish_request.after_24h_ids,callback:function(e){t.$set(t.publish_request,"after_24h_ids",e)},expression:"publish_request.after_24h_ids"}})],1)])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4"},[s("div",{staticClass:"form-group mb-0 mt-3"},[s("div",{staticClass:"checkbox-inline"},[s("label",{staticClass:"checkbox checkbox-rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.publish_request.after_48h,expression:"publish_request.after_48h"}],attrs:{type:"checkbox",name:"Checkboxes15_1"},domProps:{checked:Array.isArray(t.publish_request.after_48h)?t._i(t.publish_request.after_48h,null)>-1:t.publish_request.after_48h},on:{change:function(e){var s=t.publish_request.after_48h,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=t._i(s,null);a.checked?r<0&&t.$set(t.publish_request,"after_48h",s.concat([null])):r>-1&&t.$set(t.publish_request,"after_48h",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.publish_request,"after_48h",i)}}}),t._v(" "),s("span"),t._v("Send after 48H :\n                        ")])])])]),t._v(" "),s("div",{staticClass:"col-md-8"},[s("div",{staticClass:"form-group mb-0"},[s("v-autocomplete",{attrs:{items:t.entites,"small-chips":"",disabled:!t.publish_request.after_48h,clearable:"",multiple:"",dense:"",filled:""},model:{value:t.publish_request.after_48h_ids,callback:function(e){t.$set(t.publish_request,"after_48h_ids",e)},expression:"publish_request.after_48h_ids"}})],1)])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-12"},[s("div",{staticClass:"form-group mb-0 mt-3"},[s("div",{staticClass:"checkbox-inline"},[s("label",{staticClass:"checkbox checkbox-rounded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.publish_request.publish_online,expression:"publish_request.publish_online"}],attrs:{type:"checkbox",name:"Checkboxes15_1"},domProps:{checked:Array.isArray(t.publish_request.publish_online)?t._i(t.publish_request.publish_online,null)>-1:t.publish_request.publish_online},on:{change:function(e){var s=t.publish_request.publish_online,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=t._i(s,null);a.checked?r<0&&t.$set(t.publish_request,"publish_online",s.concat([null])):r>-1&&t.$set(t.publish_request,"publish_online",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.publish_request,"publish_online",i)}}}),t._v(" "),s("span"),t._v("\n                          Publish online\n                          "),s("b",{staticClass:"ml-2"},[t._v("( show to all connected visitors)")])])])])])]),t._v(" "),t.validationErrors?s("validation-errors",{attrs:{errors:t.validationErrors}}):t._e()],1),t._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])]),t._v(" "),s("div",{staticClass:"tab-pane fade",attrs:{id:"kt_tab_pane_2",role:"tabpanel","aria-labelledby":"kt_tab_pane_2"}},[s("div",{staticClass:"modal-body"},[s("v-card",{staticStyle:{"box-shadow":"none"}},[s("v-data-table",{staticClass:"table no-td-rl-p",attrs:{"hide-default-footer":"",headers:t._headers_entreprises,items:t.rfq_entreprises},scopedSlots:t._u([{key:"item.entreprise_label",fn:function(e){var a=e.item;return[s("div",{staticClass:"d-flex align-items-center"},[s("div",{staticClass:"symbol symbol-50 symbol-light-success mr-2"},[s("img",{attrs:{src:a.entreprise_image,alt:""}})]),t._v(" "),s("div",{staticClass:"d-flex flex-column flex-grow-1"},[s("a",{staticClass:"text-dark text-hover-primary font-size-sm font-weight-bold",attrs:{href:"#"}},[t._v(t._s(a.entreprise_label))]),t._v(" "),a.groupe_label?s("span",{staticClass:"text-muted font-size-xs font-weight-bold"},[t._v(t._s(a.groupe_label))]):t._e()])])]}},{key:"item.sent",fn:function(e){var a=e.item;return[a.sent?s("span",{staticClass:"label label-lg label-primary label-inline"},[t._v("SENT")]):t._e(),t._v(" "),a.sent?t._e():s("span",{staticClass:"label label-lg label-warning label-inline"},[t._v("SCHEDULED")])]}},{key:"item.date_human",fn:function(e){var a=e.item;return[s("span",{staticClass:"d-block font-roboto"},[t._v(t._s(a.date_human))])]}}])})],1)],1),t._v(" "),t._m(20)])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-email"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon2-phone"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-user"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-home"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-earth-globe"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-home"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-whatsapp"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{},[e("i",{staticClass:"flaticon-multimedia"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-clean btn-sm btn-icon-md",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[this._v("\n                    Actions\n                    "),e("i",{staticClass:"ml-2 ki ki-bold-more-hor icon-md"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-interface-5"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"fa la-times"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"navi-link",attrs:{href:"#modal_form_approuver","data-toggle":"modal"}},[e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-interface-5"})]),this._v(" "),e("span",{staticClass:"navi-text"},[this._v("Diffusion de la RFQ Direct")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-share"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-close"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-circle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"navi-link",attrs:{href:"#modal_form_approuver","data-toggle":"modal"}},[e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-map"})]),this._v(" "),e("span",{staticClass:"navi-text"},[this._v("Entreprises contactées")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-delete"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn btn-clean btn-icon btn-md mr-1 d-none",attrs:{href:"#"}},[e("i",{staticClass:"flaticon-upload-1 icon-lg"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[this._v("Diffusion de la RFQ Direct :")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"nav nav-tabs nav-tabs-line mb-5"},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#kt_tab_pane_1"}},[e("span",{staticClass:"nav-icon"},[e("i",{staticClass:"flaticon2-chat-1"})]),this._v(" "),e("span",{staticClass:"nav-text"},[this._v("Envoyer à :")])])]),this._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#kt_tab_pane_2"}},[e("span",{staticClass:"nav-icon"},[e("i",{staticClass:"flaticon2-pie-chart-4"})]),this._v(" "),e("span",{staticClass:"nav-text"},[this._v("Entreprises contactées")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[this._v("Fermer")])])}],!1,null,null,null);e.default=l.exports}}]);