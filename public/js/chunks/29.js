(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{215:function(t,e,s){"use strict";s.r(e);var a={data:function(){return{url:"entreprises",validationErrors:null,ville_search:null,entreprises:[],entreprise_id:null,statuts:[],villes:[],rubriques:[],filter:{secteur:null,ville:null,statut:null},entreprise:{id:null,label:null,prenom:null,tel:null,image:null,image_url:null,ville_id:null,secteur_id:null,enabled:null,email:null,secteurs_id:[]},edit:!1}},created:function(){this.$route.query.statut&&(this.filter.statut=parseInt(this.$route.query.statut)),this.fetch()},methods:{fetch:function(t){var e={};$.each(this.filter,(function(t,s){e[t]=s})),axios.get(this.url,{params:e}).then(function(t){this.entreprises=t.data.entreprises,t.data.statuts&&(this.statuts=t.data.statuts),t.data.villes&&(this.villes=t.data.villes),t.data.rubriques&&(this.rubriques=t.data.rubriques)}.bind(this)).catch((function(t){return console.log(t)}))},deleteEntreprise:function(t){swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"question",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(function(e){var s=this;e.value&&axios.delete(this.url+t).then((function(t){swal.fire("Deleted!","Your file has been deleted.","success"),s.fetch()})).catch((function(t){return console.log(t)}))}.bind(this))},sendPassword:function(t){swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"question",showCancelButton:!0,confirmButtonText:"Oui !"}).then(function(e){var s=this;if(e.value){var a={};a.entreprise=t,axios.get(this.url+"/password",{params:a}).then((function(t){swal.fire("Email envoyé !","Merci de consulter votre boite email, un email vous a été envoyé, contenant votre nouveau mot de passe.","success"),s.fetch()})).catch((function(t){return console.log(t)}))}}.bind(this))},save:function(){var t=this,e=new FormData;$.each(this.entreprise,(function(t,s){e.append(t,s||"")})),axios.post(this.url,e,{headers:{"content-type":"multipart/form-data"}}).then((function(e){t.clearForm(),$("#modal_form_entreprise").modal("toggle"),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},saveCompetences:function(){var t=this,e={};e.entreprise=this.entreprise_id,e.competences=this.entreprise_competences,axios.post(this.url+"/competences",e).then((function(e){$("#modal_form_competences").modal("toggle"),t.fetch()})).catch((function(e){422==e.response.status&&(t.validationErrors=e.response.data.errors)}))},addEntreprise:function(){this.clearForm(),this.entreprise.image_url="https://via.placeholder.com/300/004c68/FFF?text=Logo",this.validationErrors=null;new KTImageInput("kt_user_edit_avatar")},editEntreprise:function(t){$("#modal_form_entreprise").modal("toggle"),this.validationErrors=null,this.edit=!0;new KTImageInput("kt_user_edit_avatar");$.each(this.entreprise,function(e,s){this.entreprise[e]=t[e]}.bind(this))},clearForm:function(){this.edit=!1,$.each(this.entreprise,function(t,e){this.entreprise[t]=null}.bind(this))},onImageChange:function(t){this.entreprise.image=t.target.files[0]}}},i=s(4),l=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"subheader py-2 py-lg-4 subheader-solid",attrs:{id:"kt_subheader"}},[s("div",{staticClass:"container-fluid d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap"},[s("div",{staticClass:"d-flex align-items-center flex-wrap mr-2"},[s("h5",{staticClass:"text-dark font-weight-bold mt-2 mb-2 mr-5"},[t._v("Entreprises")]),t._v(" "),s("div",{staticClass:"d-flex align-items-center",attrs:{id:"kt_subheader_search"}},[s("span",{staticClass:"text-dark-50 font-weight-bold",attrs:{id:"kt_subheader_total"}},[t._v(t._s(t.entreprises.length)+" Entreprises")])])]),t._v(" "),s("div",{staticClass:"d-flex align-items-center"},[s("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:{name:"entreprise_profile"}}},[s("i",{staticClass:"ki ki-plus icon-1x"}),t._v("Ajouter une entreprise\n        ")])],1)])]),t._v(" "),s("div",{staticClass:"d-flex flex-column-fluid"},[s("div",{staticClass:"container-fluid"},[1==t.$auth.user().role_id?s("div",{staticClass:"card card-custom gutter-b mb-2"},[s("div",{staticClass:"card-body p-2 pr-8 pl-8"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-xl-3"},[s("div",{staticClass:"form-group mb-0"},[s("label",[t._v("Statut")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.statuts,clearable:"",dense:"",filled:""},model:{value:t.filter.statut,callback:function(e){t.$set(t.filter,"statut",e)},expression:"filter.statut"}})],1)]),t._v(" "),s("div",{staticClass:"col-xl-3"},[s("div",{staticClass:"form-group mb-0"},[s("label",[t._v("Ville")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.villes,clearable:"",dense:"",filled:""},model:{value:t.filter.ville,callback:function(e){t.$set(t.filter,"ville",e)},expression:"filter.ville"}})],1)]),t._v(" "),s("div",{staticClass:"col-xl-3"},[s("div",{staticClass:"form-group mb-0"},[s("label",[t._v("Secteur d'activité")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.rubriques,clearable:"",dense:"",filled:""},scopedSlots:t._u([{key:"item",fn:function(e){return[[s("v-list-item-avatar",{staticStyle:{"border-radius":"0"}},[e.item.parent_label?t._e():s("img",{attrs:{src:e.item.avatar}}),t._v(" "),e.item.parent_label?s("img",{staticStyle:{width:"25px",height:"25px"},attrs:{src:e.item.avatar}}):t._e()]),t._v(" "),s("v-list-item-content",[s("v-list-item-title",{domProps:{innerHTML:t._s(e.item.text)}}),t._v(" "),s("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.parent_label)}})],1)]]}}],null,!1,3605748394),model:{value:t.filter.secteur,callback:function(e){t.$set(t.filter,"secteur",e)},expression:"filter.secteur"}})],1)]),t._v(" "),s("div",{staticClass:"col-xl-2 mt-7"},[s("button",{staticClass:"btn btn-primary btn-block",on:{click:function(e){return t.fetch()}}},[t._m(0),t._v(" "),s("span",{staticClass:"navi-text"},[t._v("Filtrer")])])])])])]):t._e(),t._v(" "),s("div",{staticClass:"row"},t._l(t.entreprises,(function(e){return s("div",{key:e.id,staticClass:"col-xl-3 col-lg-6 col-md-6 col-sm-6"},[s("div",{staticClass:"card card-custom"},[s("div",{staticClass:"card-body p-5 pt-4"},[s("div",{staticClass:"d-flex justify-content-end"},[s("div",{staticClass:"dropdown dropdown-inline",attrs:{"data-toggle":"tooltip",title:"","data-placement":"left","data-original-title":"Quick actions"}},[t._m(1,!0),t._v(" "),s("div",{staticClass:"dropdown-menu dropdown-menu-md dropdown-menu-right"},[s("ul",{staticClass:"navi navi-hover"},[t._m(2,!0),t._v(" "),s("li",{staticClass:"navi-separator mb-3 opacity-70"}),t._v(" "),s("li",{staticClass:"navi-item"},[s("router-link",{staticClass:"navi-link",attrs:{to:{name:"entreprise_profile",params:{id:e.id}}}},[s("span",{staticClass:"navi-text"},[s("i",{staticClass:"flaticon2-user"}),t._v(" "),s("span",{staticClass:"ml-2"},[t._v("Profile")])])])],1),t._v(" "),s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link",on:{click:function(s){return t.editEntreprise(e)}}},[t._m(3,!0)])]),t._v(" "),s("li",{staticClass:"navi-item"},[s("a",{staticClass:"navi-link d-none",on:{click:function(s){return t.deleteEntreprise(e.id)}}},[t._m(4,!0)])])])])])]),t._v(" "),s("div",{staticClass:"d-flex align-items-end mb-7"},[s("div",{staticClass:"d-flex align-items-center"},[s("div",{staticClass:"flex-shrink-0 mr-4 mt-lg-0 mt-3"},[s("div",{staticClass:"symbol symbol-circle symbol-lg-75"},[s("img",{staticClass:"kt-widget__img kt-hidden-",attrs:{src:e.image_url,alt:"image"}})])]),t._v(" "),s("div",{staticClass:"d-flex flex-column"},[s("router-link",{staticClass:"text-dark font-weight-bolder text-hover-primary font-size-h6 mb-1",staticStyle:{"line-height":"1.2"},attrs:{to:{name:"entreprise_profile",params:{id:e.id}}}},[t._v(t._s(e.label))]),t._v(" "),s("span",{},[t._v(t._s(e.secteur_label))])],1)])]),t._v(" "),s("div",{staticClass:"mb-3 mt-3"},[s("div",{staticClass:"d-flex justify-content-between align-items-center"},[s("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Email :")]),t._v(" "),s("a",{staticClass:"text-muted text-hover-primary",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden",width:"75%"},attrs:{href:"#"}},[t._v(t._s(e.email))])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-cente my-1"},[s("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Tél. :")]),t._v(" "),s("a",{staticClass:"text-muted text-hover-primary",attrs:{href:"#"}},[t._v(t._s(e.tel))])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-center"},[s("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Ville :")]),t._v(" "),s("span",{staticClass:"text-muted font-weight-bold"},[t._v(t._s(e.ville_label))])]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-center mt-1"},[s("span",{staticClass:"text-dark-75 font-weight-bolder mr-2"},[t._v("Statut :")]),t._v(" "),s("span",{staticClass:"label label-md label-inline font-weight-normal",style:{color:"rgb("+e.statut_color+")","background-color":"rgb("+e.statut_color+",.2)"}},[t._v(t._s(e.statut_label))])])])])])])})),0)])]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"modal_form_entreprise",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[s("div",{staticClass:"modal-header"},[t.entreprise.id?t._e():s("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Ajouter une entreprise")]),t._v(" "),t.entreprise.id?s("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Modifier une entreprise")]):t._e(),t._v(" "),s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})]),t._v(" "),s("form",{staticClass:"mb-3",on:{submit:function(e){return e.preventDefault(),t.save(e)}}},[s("div",{staticClass:"modal-body"},[s("div",{staticClass:"form-group mt-2 mb-2 text-center"},[s("div",{staticClass:"image-input image-input-empty image-input-outline",style:{"background-image":"url("+t.entreprise.image_url+")"},attrs:{id:"kt_user_edit_avatar"}},[s("div",{staticClass:"image-input-wrapper"}),t._v(" "),s("label",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"change","data-toggle":"tooltip",title:"","data-original-title":"Change avatar"}},[s("i",{staticClass:"fa fa-pen icon-sm text-muted"}),t._v(" "),s("input",{attrs:{type:"file",name:"profile_avatar",accept:".png, .jpg, .jpeg, .svg"},on:{change:t.onImageChange}}),t._v(" "),s("input",{attrs:{type:"hidden",name:"profile_avatar_remove"}})]),t._v(" "),t._m(5),t._v(" "),t._m(6)])]),t._v(" "),s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Enseigne :")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.entreprise.label,expression:"entreprise.label"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Enseigne"},domProps:{value:t.entreprise.label},on:{input:function(e){e.target.composing||t.$set(t.entreprise,"label",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("GSM")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.entreprise.tel,expression:"entreprise.tel"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"GSM"},domProps:{value:t.entreprise.tel},on:{input:function(e){e.target.composing||t.$set(t.entreprise,"tel",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Email")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.entreprise.email,expression:"entreprise.email"}],staticClass:"form-control",attrs:{type:"text",autocomplete:"off",placeholder:"Emaill"},domProps:{value:t.entreprise.email},on:{input:function(e){e.target.composing||t.$set(t.entreprise,"email",e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6 pt-0"},[s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Ville :")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.villes,clearable:"",dense:"",filled:""},model:{value:t.entreprise.ville_id,callback:function(e){t.$set(t.entreprise,"ville_id",e)},expression:"entreprise.ville_id"}})],1)]),t._v(" "),s("div",{staticClass:"col-md-6 pt-0"},[s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Secteur principal :")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.rubriques,clearable:"",dense:"",filled:""},scopedSlots:t._u([{key:"item",fn:function(e){return[[s("v-list-item-avatar",{staticStyle:{"border-radius":"0"}},[e.item.parent_label?t._e():s("img",{attrs:{src:e.item.avatar}}),t._v(" "),e.item.parent_label?s("img",{staticStyle:{width:"25px",height:"25px"},attrs:{src:e.item.avatar}}):t._e()]),t._v(" "),s("v-list-item-content",[s("v-list-item-title",{domProps:{innerHTML:t._s(e.item.text)}}),t._v(" "),s("v-list-item-subtitle",{domProps:{innerHTML:t._s(e.item.parent_label)}})],1)]]}}]),model:{value:t.entreprise.secteur_id,callback:function(e){t.$set(t.entreprise,"secteur_id",e)},expression:"entreprise.secteur_id"}})],1)])]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-control-label",attrs:{for:"recipient-name"}},[t._v("Secteurs :")]),t._v(" "),s("v-autocomplete",{attrs:{items:t.rubriques,clearable:"",dense:"",multiple:"","small-chips":"",filled:""},model:{value:t.entreprise.secteurs_id,callback:function(e){t.$set(t.entreprise,"secteurs_id",e)},expression:"entreprise.secteurs_id"}})],1),t._v(" "),t.validationErrors?s("validation-errors",{attrs:{errors:t.validationErrors}}):t._e()],1),t._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.clearForm()}}},[t._v("Fermer")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Enregistrer")])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-icon"},[e("i",{staticClass:"flaticon-search"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn btn-clean btn-hover-light-primary btn-sm btn-icon",attrs:{href:"#","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e("i",{staticClass:"ki ki-bold-more-hor"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"navi-header font-weight-bold py-4"},[e("span",{staticClass:"font-size-lg"},[this._v("Actions :")]),this._v(" "),e("i",{staticClass:"flaticon2-information icon-md text-muted",attrs:{"data-toggle":"tooltip","data-placement":"right",title:"","data-original-title":"Click to learn more..."}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-text"},[e("i",{staticClass:"flaticon2-edit"}),this._v(" "),e("span",{staticClass:"ml-2"},[this._v("Modifier")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"navi-text"},[e("i",{staticClass:"flaticon2-rubbish-bin-delete-button"}),this._v(" "),e("span",{staticClass:"ml-2"},[this._v("Supprimer")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"cancel","data-toggle":"tooltip",title:"Cancel avatar"}},[e("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"btn btn-xs btn-icon btn-circle btn-white btn-hover-text-primary btn-shadow",attrs:{"data-action":"remove","data-toggle":"tooltip",title:"Remove avatar"}},[e("i",{staticClass:"ki ki-bold-close icon-xs text-muted"})])}],!1,null,null,null);e.default=l.exports}}]);